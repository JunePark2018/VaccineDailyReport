class NewsEditor:
    def __init__(self, ai_helper):
        self.ai = ai_helper

    def generate_balanced_article(self, cluster_topic, articles):
        """
        cluster_topic: 해당 군집의 주제 (예: 'IT/과학', '경제')
        articles: 해당 군집에 속한 기사 리스트
        """
        
        # 1. 기사 내용 합치기
        context_text = ""
        for idx, art in enumerate(articles):
            context_text += f"[{idx+1}] 언론사: {art['company_name']} | 제목: {art['title']}\n    내용: {art['contents']}\n\n"

        # 2. 시스템 프롬프트 (역할 부여)
        # [수정] '팩트 검증에 철저한'이라는 수식어를 추가하여 역할 정의
        system_role = (
            "당신은 중복 없이 간결하고 명확한 문장을 구사하며, 팩트 검증에 철저한 '수석 편집장'입니다. "
            "여러 기사를 읽고, 독자가 한 번에 이해할 수 있도록 내용을 재구성하십시오."
        )

        # 3. 유저 프롬프트 (팩트 준수 원칙 추가)
        user_prompt = f"""
        주제: '{cluster_topic}'
        
        아래 제공된 기사 소스들을 바탕으로 **하나의 완결된 스트레이트 뉴스**를 작성하세요.

        [수집된 기사 소스]
        {context_text}

        [🚨 작성 절대 원칙 - 어길 시 해고]
        1. **팩트 준수 (Fact-Only)**: 제공된 기사 소스에 없는 내용은 절대 창작하거나 추측하여 쓰지 마십시오. 오직 주어진 텍스트 데이터에 기반해서만 서술해야 합니다. (없는 내용은 아예 언급하지 말 것)
        2. **중복 금지**: 앞에서 언급한 문장이나 단락을 절대 다시 쓰지 마십시오. 똑같은 내용을 단어만 바꿔서 반복하는 것도 금지합니다.
        3. **객관성 유지**: 감정적인 형용사나 과장된 표현을 배제하고, 건조하고 전문적인 보도체를 유지하십시오.
        4. **논리적 흐름**: [서론 -> 본론 -> 결론]의 흐름이 끊기지 않고 자연스럽게 이어지도록 하십시오.

        [기사 구조 가이드라인]
        1. **헤드라인**: 전체를 아우르는 30자 이내의 제목 (단 1개만 작성)
        2. **리드(서두)**: 첫 문단만 읽어도 핵심(누가, 무엇을, 왜)을 알 수 있게 요약하십시오.
        3. **본문**: 
           - 반복되는 팩트는 하나로 합치십시오.
           - 시간 순서나 인과 관계(원인->결과)에 따라 내용을 배치하십시오.
           - "A에 따르면", "B에 따르면" 같은 출처 나열을 피하고 사건 중심으로 서술하십시오.
        4. **마무리**: 향후 전망이나 업계 반응으로 끝맺음하십시오.

        위 가이드라인을 철저히 지켜 기사를 작성해 주세요.
        """

        # 4. AI에게 요청
        return self.ai.ask(system_role, user_prompt)